<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
"http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd">
<chapter id="android-dev">
  <title>Développez des applications Android avec Maven</title>

  <section id="android-dev-sect-intro">
    <title>Introduction</title>

    <para>Android est un téléphone portable et un système d'exploitation embarqué développé par l'Open Handset Alliance. 
    Il est basé sur un noyau Linux avec et possède une machine virtuelle utilisant interprétant du bytecode Java.
    L'environnement de développement est basé sur le langage Java et les outils du JDK et de la JVM.
    Le bytecode Java généré  est transformé en code exécutable Dalvik optimisé pour répondre aux contraintes liées aux enjeux de la mobilité.
    Java est le langage de programmation par défaut, les différentes API sont basées sur celui-ci.</para>

    <para>Dans la plupart des cas, le développement d'applications Android s'effectue dans Eclipse avec l'Android Development Toolkit (<acronym>ADT</acronym>).
    Il vous est également possible de construire vos applications en dehors de cet IDE en utilisant par l'intermédiaire d'Apache Ant.
    Le pluging Maven Android a été créé pour permettre aux équipes de développement de construire, déployer et la publier des applications Android avec Apache Maven, 
    permettant ainsi de tirer parti des fonctionnalités disponibles comme la gestion des dépendances, le reporting ou l'analyse de code…</para>
  </section>

  <section id="android-dev-sect-config-build">
    <title>Configurez un environnement de build pour le développement Android</title>

    <para><indexterm>
        <primary>Android</primary>

        <secondary>configurez un environnement de build</secondary>
      </indexterm>Avant d'essayer de construire vos bibliothèques et vos applications Maven, vous devez effectuer les tâches suivantes :</para>

    <itemizedlist>
      <listitem>
        <para>Installation du SDK Android</para>
      </listitem>

      <listitem>
        <para>Installation des jars de l'API Android dans un dépôt local ou distant</para>
      </listitem>

      <listitem>
        <para>Configurer Maven pour simplifier l'utilisation du Maven Android Plugin</para>
      </listitem>
    </itemizedlist>

    <section id="android-dev-sect-sdk-install">
      <title>Installation du SDK Android</title>

      <para>Le plugin Android Maven nécessite la présence du SDK Android dans votre environnement de développement.
      La variable d'environnement <varname>ANDROID_HOME</varname> doit être configurée pour pointer vers le répertoire d'installation du SDK Android.
      Le SDK doit être installé en suivant les consignes du site web Android Developer dont voici l'adresse <uri>http://developer.android.com/sdk/index.html</uri>. 
      Par exemple, si le sdk est installé dans le répertoire <varname>/opt/android-sdk-linux </varname>, 
      la commande suivante permet d'initialiser cette variable correctement <programlisting>export ANDROID_HOME=/opt/android-sdk-linux</programlisting> sur un environnement Unix/bash.
      Sous Windows, utilisez la commande suivante : <programlisting>set ANDROID_HOME=C:\\opt\android-sdk-linux</programlisting></para>

      <para>En plus du SDK, les différentes versions des plates-formes dont vous avez besoin pour le développement doivent également être installées.
      Les consignes d'installation sont détaillées à cette adresse : <uri>http://developer.android.com/sdk/adding-components.html</uri>. 
      Vous pouvez installer les versions des plates-formes que vous vous avez besoin, ou, plus simplement, vous contenter d'installer toutes les plates-formes.
      De plus, vous pouvez également rajouter le répertoire <varname>ANDROID_HOME/tools</varname> à votre <varname>PATH</varname> pour vous faciliter l'utilisation des différents outils fournis par le SDK en ligne de commande.</para> 
    </section>

    <section id="android-dev-sect-repository-install">
      <title>Installation des artifacts Android dans un dépôt Maven</title>

      <para>Une fois que le SDK est installé, vous devez mettre à disposition les différents JARs d'API dans un dépôt Maven. 
      L'outil Maven Android SDK Deployer vous permet d'effectuer cette tâche en déployant ces JARs soit dans votre dépôt local, soit sur un dépôt distant.
<!-- TODO link to nexus... in general how much do we have
        to explain here about this stuff, i would prefer to add links to the nexus book chapters somehow.. --></para>

      <para>Cet outil, le Maven Android SDK Deployer est disponible à cette adresse :</para>

      <para><uri>http://github.com/mosabua/maven-android-sdk-deployer</uri></para>

      <para>Cliquez simplement sur le button <varname>Download Source</varname> et dézippez l'archive téléchargée dans le dossier de votre choix.
      Un dossier avec urn nom du type <varname>mosabua-maven-android-sdk-deployer-XXX</varname> sera alors créé. 
      <varname>XXX</varname> désignant un numéro de révision du type <varname>df824df</varname>. 
      Déplacez-vous ensuite dans ce nouveau répertoire :<programlisting>cd mosabua-maven-android-sdk-deployer-df824df</programlisting></para>

      <section id="android-dev-sect-repository-install-local">
        <title>Installation dans votre dépôt local</title>

        <para>Pour installer les JARs d'API de différentes versions de plates-formes dans votre dépôt local, 
        vous pouvez exécuter la commande  suivante à partir du dossier de votre deployer : <programlisting>mvn clean install</programlisting>.
	Par défaut, cette commande installe les JARs <varname>android.jar</varname> et <varname>mas.jar</varname> dans votre dépôt local.
	Vous devriez donc trouver ces fichiers tout juste installés dans les groupes <varname>android</varname> et <varname>com.google.android.maps</varname> 
        dans le répertoire <filename>~/.m2/repository</filename>.</para>
      </section>

      <section id="android-dev-sect-repository-install-remote">
        <title>Installation dans urn depot distant</title>

        <para>Le mécanisme précédent fonctionne très bien pour une seule machine, mais si vous devez fournir ces artefacts à une équipe de développeurs,
        vous voudrez probablement déployer ces mêmes artefacts sur un dépôt distant accessible par l'ensemble des utilisateurs.
	Si vous n'utilisez pas de gestionnaire de dépôt, envisagez l'installation de Nexus avec un utilisateur configuré pour déployer les artefacts sur un dépôt.
	Pour cela, nous vous encourageons à lire les consignes d'installation de Nexus qui sont disponibles gratuitement à cette adresse dans son livre en ligne :
        <ulink url="http://www.sonatype.com/books/nexus-book/reference/install.html">Nexus Installation chapter</ulink>.</para>

        <para>En premier lieu, vous devez renseigner la propriété <varname>repo.url</varname> dans le <varname>pom.xml</varname> 
        de plus haut niveau dans l'arborescence de dossier de l'outil  Android SDK Deployer afin de configurer le dépôt dans lequel vous voulez publier vos artefacts.
	Ensuite, vous devez ajouter un serveur dans les settings Maven dans le fichier <filename>~/.m2/settings.xml</filename>.

	<example>
            <title>Extrait du fichier <varname>settings.xml</varname> qui indique les accès au dépôt et ses données d'authentification</title>

            <programlisting>&lt;settings&gt;
    &lt;servers&gt;
        &lt;server&gt;
            &lt;id&gt;android.repo&lt;/id&gt;
            &lt;username&gt;your username&lt;/username&gt;
            &lt;password&gt;your password&lt;/password&gt;
        &lt;/server&gt;
    &lt;/servers&gt;
&lt;/settings&gt;
</programlisting>
          </example>
	Une fois cette configuration effectuée, vous pouvez déployer vos artefacts en utilisant la commande <command>mvn deploy</command>. 
	Lorsque celle-ci est terminée, vous devriez être capable de retrouver ces artefacts sur votre serveur distant.
        <!-- TODO ??
          For more information about this stuff look at the documentation for the maven-deploy-plugin.
          or better chapter bla in this book.. --></para>
      </section>

      <section id="android-dev-sect-repository-install-parts">
        <title>Installation dune partie des plates-formes</title>

        <para>Par défaut, l'outil Maven Android SDK Deployer est configuré pour installer toutes les versions des artefacts de toutes les plates-formes Android dans un dépôt.
	Si vous désirez n'installer qu'une partie de ces plateformes, voire une seule, vous pouvez utiliser différentes options par l'intermédiaire de <varname>profile</varname>.
	Pour cela, vous devez spécifier les versions que vous désirez par l'intermédiaire de leur nom de <varname>profile</varname> correspondant : 
	<programlisting>mvn install -P 2.1</programlisting>
	Les noms de profiles actuellement disponibles sont : <varname>1.1</varname>, <varname>1.5</varname>,
        <varname>1.6</varname>, <varname>2.0</varname> and
        <varname>2.1</varname>.</para>
      </section>
    </section>

    <section id="android-dev-sect-plugin-config">
      <title>Configurer Maven pour qu'il utilise le Maven Android Plugin</title>

      <para>Afin de pouvoir utiliser les goals du Maven Android Plugin à partir de la ligne de commande en utilisant la version courte du nom du plugin <varname>android</varname>,
      vous devez ajouter l'extrait de configuration suivant dans votre fichier <varname>settings.xml</varname>.</para>

      <example>
        <title>Extrait du <varname>settings.xml</varname> pour pouvoir utiliser le plugin avec son nom court</title>

        <programlisting>&lt;pluginGroups&gt;
   &lt;pluginGroup&gt;
     com.jayway.maven.plugins.android.generation2
   &lt;/pluginGroup&gt;
&lt;/pluginGroups&gt;        </programlisting>
      </example>
    </section>
  </section>

  <section id="android-dev-sect-using">
    <title>Développement d'applications Android avec le Maven Android Plugin</title>

    <section id="android-dev-sect-helloandroidexample">
      <title>Exemple HelloFlashlight</title>

      <para>L'exemple HelloFlashlight va nous servir de point de départ pour présenter le plugin Maven Android Plugin.
      Vous pouvez suivre ces mêmes étapes pour sur applications Android pour qu'elles utilisent le Maven Android Plugin comme outil de build.
      Une fois que votre environnement est correctement configuré (tel que nous venons de le décrire dans les paragraphes précédents),
      créez un nouveau projet Android en utilisant les Android Development Tools (ADT) <uri>http://developer.android.com/sdk/eclipse-adt.html</uri>.</para>

      <para>Pour activer le build Maven d'un tel projet, ajoutez le <varname>pom.xml</varname> ci-dessous dans le dossier principal de votre projet :</para>  

      <example>
        <title><varname>pom.xml</varname> du projet HelloFlashlight</title>

        <programlisting>  &lt;?xml version="1.0" encoding="UTF-8"?&gt;
  &lt;project xmlns="http://maven.apache.org/POM/4.0.0"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xsi:schemaLocation="http://maven.apache.org/POM/4.0.0
                               http://maven.apache.org/maven-v4_0_0.xsd"&gt;
      &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
      &lt;groupId&gt;com.simpligility.android&lt;/groupId&gt;
      &lt;artifactId&gt;helloflashlight&lt;/artifactId&gt;
      &lt;version&gt;0.1-SNAPSHOT&lt;/version&gt;
      &lt;packaging&gt;apk&lt;/packaging&gt;
      &lt;name&gt;HelloFlashlight&lt;/name&gt;

      &lt;dependencies&gt;
          &lt;dependency&gt;
              &lt;groupId&gt;android&lt;/groupId&gt;
              &lt;artifactId&gt;android&lt;/artifactId&gt;
              &lt;version&gt;2.1_r1&lt;/version&gt;
              &lt;scope&gt;provided&lt;/scope&gt;
          &lt;/dependency&gt;
      &lt;/dependencies&gt;

      &lt;build&gt;
          &lt;sourceDirectory&gt;src&lt;/sourceDirectory&gt;
          &lt;plugins&gt;
              &lt;plugin&gt;
                  &lt;groupId&gt;
                    com.jayway.maven.plugins.android.generation2
                  &lt;/groupId&gt;
                  &lt;artifactId&gt;maven-android-plugin&lt;/artifactId&gt;
                  &lt;version&gt;2.2.3-SNAPSHOT&lt;/version&gt;
                  &lt;configuration&gt;
                      &lt;sdk&gt;
                          &lt;platform&gt;2.1&lt;/platform&gt;
                      &lt;/sdk&gt;
                      &lt;deleteConflictingFiles&gt;
                        true
                      &lt;/deleteConflictingFiles&gt;
                  &lt;/configuration&gt;
                  &lt;extensions&gt;true&lt;/extensions&gt;
              &lt;/plugin&gt;
              &lt;plugin&gt;
                  &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
                  &lt;configuration&gt;
                      &lt;source&gt;1.5&lt;/source&gt;
                      &lt;target&gt;1.5&lt;/target&gt;
                  &lt;/configuration&gt;
              &lt;/plugin&gt;
          &lt;/plugins&gt;
      &lt;/build&gt;
  &lt;/project&gt;
        </programlisting>
      </example>

      <para>Veuillez noter les points suivants dans ce <varname>pom.xml</varname> : <itemizedlist>
          <listitem>
            <para>Le type de <varname>packaging</varname> est
            <varname>apk</varname></para>
          </listitem>

          <listitem>
            <para>la dépendance vers le jar de la plate-forme</para>
          </listitem>

          <listitem>
            <para>la configuration du <varname>build</varname> avec les plugins Maven Android Plugin
            et Compiler Plugin</para>
          </listitem>
        </itemizedlist></para>

      <para>Le type de <varname>packaging</varname> <varname>apk</varname> permet d'activer le cycle de vie spécifique à Android.
      Il prend soin de tous les appels aux outils du SDK Android,  gestion des ressources, conversion du bytecode Java…</para> 

      <para>La dépendance vers le JAR de la plate-forme doit utiliser la version de la cible telle qu'elle a été publiée dans le dépôt Maven par l'Android SDK Deployer.
      Il récupère les versions à partir des valeurs <varname>Platform.Version</varname> et <varname>Pkg.Revision</varname> 
      renseignées dans le fichier de propriétés <varname>source.properties</varname> qui se trouve dans le dossier de la plate-forme du SDK Android.
      Les valeurs possibles sont à ce jour : <varname>1.1_r1</varname>, <varname>1.5_r3</varname>,
      <varname>1.6_r2</varname>, <varname>2.0_r1</varname>,
      <varname>2.0.1_r1</varname> and <varname>2.1_r1</varname>. 
      Naviguez simplement dans votre dépôt pour connaître la liste exacte de ces versions.</para>

      <para>La configuration du plugin Maven Compiler dans le <varname>build</varname> est nécessaire 
      car Android utilise les fonctionnalités de Java 5 telles que les annotations ou les boucles simplifiées.
      La configuration principale du plugin Maven Android est également effectuée dans cette section <varname>build</varname>.
      Dans la majorité des cas, peu de configuration est nécessaire.</para>
      

      <para>Pour construire l'application et l'exécuter sur un émulateur déjà lancé, vous pouvez utiliser la commande 
      <programlisting>mvn clean install android:deploy</programlisting>.<!--TODO potentially add commandline output for build here-->
      Le code de l'application d'exemple est disponible dans les <varname>maven-android-plugin-samples</varname> à cette adresse :
      <uri>http://code.google.com/p/maven-android-plugin/wiki/Samples</uri>.</para>
    </section>

    <section id="android-dev-sect-test">
      <title>Test du code d'une application Android</title>

      <para>Le test du code d'une application Android peut-être effectué à la manière d'un test unitaire traditionnel <varname>junit</varname> dans le cadre de l'Android SDk,
      mais aussi par l'intermédiaire de tests d'intégration. Ces derniers sont appelés 'instrumentation tests'.</para>

      <section id="android-dev-sect-test-unit">
        <title>Tests unitaires</title>

        <para>Le plugin Android Maven lance l'exécution des tests unitaires à la manière du plugin Surefire.
        Comme le chemin par défaut des classes de tests dans Eclipse et dans l'Android Development Toolkit est <varname>test</varname>,
	Maven doit être configuré spécifiquement pour qu'il puisse accéder à ce code. <example>
            <title>Ajout d'un dossier <varname>test</varname> dans la configuration <varname>build</varname></title>

            <programlisting>&lt;build&gt;
  &lt;testSourceDirectory&gt;test&lt;/testSourceDirectory&gt;
  ...          </programlisting>
          </example>
	D'une autre manière, il vous est également possible de suivre les conventions Maven et de déplacer le code de votre application et de vos tests dans les répertoires
	<varname>src/main/java</varname> et <varname>src/test/java</varname> et de réconfigurer Eclipse pour qu'il suive ce pattern.</para>
      </section>

      <section id="android-dev-sect-test-instrumentation">
        <title>Test d'instrumentation</title>

        <para>Les tests d'instrumentation sont des tests d'intégration packagés dans une application qui est lancée dans un émulateur ou un téléphone
	et qui interagit avec une autre application pour tester son comportement.
	La configuration standard pour exécuter les ces tests d'instrumentation est d'avoir deux projets distincts :
	l'un pour l'application, l'autre pour les tests d'intrumentation.
	Ces modules sont liés par l'intermédiaire des balises <varname>module</varname> du pom parent.</para>

        <para>Le code du Maven Android Plugin Samples contient deux exemples de projets configurés de cette manière.
	La configuration du plugin Maven Android pour l'application contenant les tests d'instrumentation 
	est la même que pour celle de l'application principale avec une seule différence : l'ajout d'une dépendance vers l'application principale.
	Il est important d'ajouter le <varname>type</varname> de l'<varname>apk</varname> sur cette dépendance pour permettre au plugin Maven Android de trouver le package de l'application.
        <programlisting>&lt;dependency&gt;
  &lt;groupId&gt;com.simpligility.android&lt;/groupId&gt;
  &lt;artifactId&gt;intents&lt;/artifactId&gt;
  &lt;version&gt;0.1&lt;/version&gt;
  &lt;type&gt;apk&lt;/type&gt;
&lt;/dependency&gt;
</programlisting></para>
      </section>
    </section>

    <section id="android-dev-sect-maps">
      <title>Utilisez des Add Ons tel que l'extension Google Maps</title>

      <para>Pour la majorité des applications, l'artefact du SDK (android.jar) suffit,
      il arrive pourtant que certaines applications nécessitent des Add Ons.
      L'un des Add-Ons les plus connus est celui de Google Maps, celui-ci permet l'accès à l'API Google Maps.
      Cet Ad-On a été déployé dans votre dépôt Maven par l'outil Maven Android SDK Deployer.
      Afin de pouvoir utiliser cette API, vous avez besoin d'ajouter une dépendance à votre application, pour cela modifiez le <varname>pom.xml</varname> de la manière suivante :</para>
	    
      <example>
        <title>La dépendance vers l'API Google Maps</title>

        <programlisting>&lt;dependency&gt;
  &lt;groupId&gt;com.google.android.maps&lt;/groupId&gt;
  &lt;artifactId&gt;maps&lt;/artifactId&gt;
  &lt;version&gt;7_r1&lt;/version&gt;
  &lt;scope&gt;provided&lt;/scope&gt;
&lt;/dependency&gt;      </programlisting>
      </example>

      <para>Les versions suivantes sont pour le moment disponibles  <varname>3_r3</varname>,
      <varname>4_r2</varname>, <varname>5_r1</varname>,
      <varname>6_r1</varname> and <varname>7_r1</varname>. 
      Naviguez simplement dans le dossier android de dépôt pour consulter la liste des versions qui vous est disponible.</para>
    </section>

    <section id="android-dev-sect-multimodule">
      <title>Projets Maven Android multi projets</title>

      <para>Le plugin Maven Android peut être utilisé pour configurer un projet multimodule, comme par exemple ici, 3 modules liés à un même parent.</para>

      <variablelist>
        <varlistentry>
          <term>Bibliothèque de code Java</term>

          <listitem>
            <para>Ce premier module contient la logique business implémentée en Java, ou tout autre langage tournant sur la JVM, dans un jar.</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>Code de l'application Android</term>

          <listitem>
            <para>Ce second module dépend du premier, il contient le code dépendant de la plateforme Android. 
	    Ce module doit être du type <varname>APK</varname> et avoir configuré le plugin Android.</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>Tests d'instrumentation</term>

          <listitem>
            <para>Ce troisième module dépend du second module, il implémente les différents tests d'intégration de l'application.</para>
          </listitem>
        </varlistentry>
      </variablelist>

      <para>Il est possible de construire ces différents modules en même temps par l'intermédiaire d'un build multimodule.
      Cela permet, par exemple, de partager du code entre une application Android et une application Web comme des objets du modèle ou de la logique business.</para> 
    </section>

    <section id="android-dev-sect-dependencies">
      <title>Utilisation de dépendances externess</title>

      <para>Lorsque vous utilisez le plugin Maven Android, trois types de dépendances sont pris en compte.</para>

      <variablelist>
        <varlistentry>
          <term>Dépendances vers d'autres bibliothèques Java libraries</term>

          <listitem>
            <para>Les fichiers contenant le byte code Java (.class) des dépendances des bibliothèques sont transformés en code exécutable Dalvik comme tout autre code source du projet courant, 
	    ils sont ensuite inclus dans le package Android.
	    Tous les autres fichiers sont inclus en tant que ressource dans la bibliothèque source.
            Voici un morceau d'exemple : <programlisting>&lt;dependency&gt;
  &lt;groupId&gt;com.simpligility&lt;/groupId&gt;
  &lt;artifactId&gt;model&lt;/artifactId&gt;
  &lt;version&gt;0.1&lt;/version&gt;
&lt;/dependency&gt;
</programlisting></para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>Dépendances vers d'autres projets Android</term>

          <listitem>
            <para>Tout autre projet Android avec un type de packaging APK déclaré comme dépendance d'un projet Android est déployé dans l'émulateur 
            avant l'exécution des tests d'instrumentation durant la phase des tests d'intégration.
	    <programlisting>&lt;dependency&gt;
  &lt;groupId&gt;com.simpligility.android&lt;/groupId&gt;
  &lt;artifactId&gt;intents&lt;/artifactId&gt;
  &lt;version&gt;0.1&lt;/version&gt;
  &lt;type&gt;apk&lt;/type&gt;
&lt;/dependency&gt;
</programlisting></para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>Dépendances vers d'autres sources de projets Android</term>

          <listitem>
            <para>Tout autre projet Android avec un type de packaging APK déclaré comme dépendance de source est poussé dans l'application courante avec leurs assets et ressources.
	    Tout ce contenu sera ensuite utilisé pour construire une application combinant tous ces artefacts.<programlisting>&lt;dependency&gt;
  &lt;groupId&gt;com.simpligility.android&lt;/groupId&gt;
  &lt;artifactId&gt;tools&lt;/artifactId&gt;
  &lt;version&gt;0.1&lt;/version&gt;
  &lt;type&gt;apksources&lt;/type&gt;
&lt;/dependency&gt;
</programlisting> Pour plus de détail sur cette solution, consultez l'adresse suivante :
            <uri>http://code.google.com/p/maven-android-plugin/wiki/ApkSourcesDependency</uri>.</para>
          </listitem>
        </varlistentry>
      </variablelist>
    </section>

    <!--TODO To we want these sections? -->

    <!--<section id="android-dev-sect-eclipse">-->

    <!--<title>Using the plugin with Eclipse</title>-->

    <!--<para>document what needs to be done, maybe install m2eclipse, more details on the wiki and need to play around with it-->

    <!--same applies for motodev studio, http://code.google.com/p/maven-android-plugin/wiki/EclipseIntegration</para>-->

    <!--</section>-->

    <!--<section id="android-dev-sect-intellij">-->

    <!--<title>Using the plugin with IntelliJ IDEA</title>-->

    <!--<para>need to play around with it</para>-->

    <!--</section>-->
  </section>

  <section id="android-dev-sect-custom-details">
    <title>Plugin Maven Android en détails</title>

    <section id="android-dev-sect-custom-lifecycle">
      <title>Cycle de vie du plugin Maven Android</title>

      <para><indexterm>
          <primary>Plugin Maven Android</primary>

          <secondary>cycle de vie</secondary>
        </indexterm>Le plugin Maven Android personnalise le cycle de vie en fonction du type de packaging.
	Si votre projet est du type APK, le plugin Maven Android exécutera son cycle de vie spécifique.</para>

      <para>Voici la description des différentes phases de ce cycle de vie personnalisé.</para>

      <variablelist>
        <varlistentry>
          <term>Phase generate-sources</term>

          <listitem>
            <para>Utilise l'Android Asset Packaging Tool (<varname>aapt</varname>) de la plateforme spécifiée dans le pom pour packager certaines ressources comme le fichier 
            <varname>AndroidManifest.xml</varname>, les assets et  les ressources.</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>Phase process-classes</term>

          <listitem>
            <para>Exécute l'outil <varname>dx</varname> de la plateforme spécifiée dans le pom pour convertir toutes les classes 
	    (bibliothèques, ressources et code du projet) en code exécutable au format Dalvik.</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>Phase package</term>

          <listitem>
            <para>Exécute l'outil de packaging Android (<varname>apk</varname>) du SDK pour créer et signer le package APK pour qu'il puisse être installé sur un émulateur ou un téléphone.</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>Phase pre-integration-test</term>

          <listitem>
            <para>Déploie le package de l'application Android (APK) comme n'importe quelle dépendance du type de packaging APK sur l'émulateur ou le téléphone.</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>Phase integration-test</term>

          <listitem>
            <para>Exécute les classes de test d'instrumentation pour tester l'application déployée.</para>
          </listitem>
        </varlistentry>
      </variablelist>
    </section>

    <section id="android-dev-sect-goals">
      <title>Maven Android Plugin Goals</title>

      <para><indexterm>
          <primary>Maven Android</primary>

          <secondary>plugin goals</secondary>
        </indexterm> The Maven Android Plugin contains the following
      goals:</para>

      <variablelist>
        <varlistentry>
          <term>android:apk</term>

          <listitem>
            <para>

The <varname>apk</varname> goal creates the android package (apk) file. 
By default the plugin signs the file with the debug keystore. 
The configuration parameter <programlisting>&lt;sign&gt;&lt;debug&gt;false&lt;debug&gt;&lt;sign&gt;
</programlisting> can be used to disable the signing process.</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>android:deploy</term>

          <listitem>
            <para>

The <varname>deploy</varname> goal deploys the built apk file, or another specified apk, to a connected device or emulator.
This goal is automatically performed when running through the <varname>integration-test</varname> lifecycle phase on a project
with instrumentation tests (e.g. <command>mvn install</command> or
            <command>mvn integration-test</command>).</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>android:deploy-dependencies</term>

          <listitem>
            <para>

The <varname>deploy-dependencies</varname> goal deploys all directly declared dependencies of
            <varname>&lt;type&gt;apk&lt;/type&gt;</varname> in this project.
This goal is usually used in a project with instrumentation tests, 
to deploy the apk to test onto the device before running the deploying and running the instrumentation tests apk. 
The goal is automatically performed when running through the integration-test life cycle phase on a project with instrumentation tests (e.g.
            <command>mvn install</command> or <command>mvn
            integration-test</command>).</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>android:dex</term>

          <listitem>
            <para>The <varname>dex</varname> goal converts compiled Java classes to the Android Dalivk Executable (dex) format.</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>android:emulator-start</term>

          <listitem>
            <para>

The <varname>emulator-start</varname> goal starts the Android device emulator. 
The start up parameters can be configured in the Maven Android Plugin configuration in the pom.xml file
            <programlisting>&lt;configuration&gt;
  ...
  &lt;emulator&gt;
    &lt;avd&gt;21&lt;/avd&gt;
    &lt;wait&gt;6000&lt;/wait&gt;
    &lt;options&gt;-no-skin&lt;/options&gt;
  &lt;/emulator&gt;
  ...
&lt;/configuration&gt;               </programlisting> or via command line
            parameters outside an actual project. <programlisting>mvn android:emulator-start \
    -Dandroid.emulator.avd=Default \
    -Dandroid.emulator.options=-no-skin \
    -Dandroid.emulator.wait=10000              </programlisting></para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>android:emulator-stop</term>

          <listitem>
            <para>

The <varname>emulator-stops</varname> stops the Android device emulator and can be used inside or outside a Maven project folder.</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>android:generate-sources</term>

          <listitem>
            <para>
The <varname>generate-sources</varname> goal generates <varname>R.java</varname> based on the resources specified by the resources configuration parameter. 
It generates Java files based on aidl files.</para>

            <para>

If the configuration parameter <varname>deleteConflictingFiles</varname> is true (which it is by default), 
this goal has also deletes any R.java files found in the  source directory, deletes any .java files with the same name as an
.aidl file found in the source directory and deletes any Thumbs.db files found in the resource directory.</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>android:instrument</term>

          <listitem>
            <para>The <varname>instrument</varname> goal runs the
            instrumentation android package on the device/emulator.</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>android:internal-integration-test</term>

          <listitem>
            <para>

The <varname>internal-integration-test</varname> goal is called automatically when the lifecycle reaches the <varname>integration-test</varname> phase. 
It determines whether to call the goal instrument in this phase based on the existence of instrumentation test classes in the current project. 
The goal is internal to the plugin lifecycle and should not be used as separate invocation on the command line.</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>android:internal-pre-integration-test</term>

          <listitem>
            <para>

The <varname>internal-pre-integration-test</varname> goal is called automatically when the lifecycle reaches <varname>pre-integration-test</varname> phase. 
It determines whether to call the goals <varname>android:deploy-dependencies</varname> and <varname>android:deploy</varname> in this phase 
and if necessary invokes them. 
The goal is internal to the plugin lifecycle and should not be used as separate invocation on the command line.</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>android:pull</term>

          <listitem>
            <para>The pull goal can be used to copy files or directories from the device.</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>android:push</term>

          <listitem>
            <para>The pull goal can be used to copy files or directories to the device.</para>
          </listitem>
        </varlistentry>

        <varlistentry>
          <term>android:undeploy</term>

          <listitem>
            <para>The undeploy goal removes the apk of the current project, or another specified apk, from the connected device.</para>
          </listitem>
        </varlistentry>
      </variablelist>
    </section>
  </section>
</chapter>
